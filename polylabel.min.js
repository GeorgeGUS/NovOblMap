ymaps.modules.define("polylabel.config",[],function(t){t({MIN_ZOOM:0,MAX_ZOOM:23,DEFAULT_POLYGON_FILL_COLOR:"0066ff99",options:["labelLayout","labelDotLayout","labelDotVisible","labelDefaults","labelCursor","labelDotCursor"],zoomRangeOptions:["labelClassName","labelForceVisible","labelTextColor","labelTextSize","labelCenterCoords","labelOffset","labelPermissibleInaccuracyOfVisibility"],properties:[]})}),ymaps.modules.define("polylabel.create",["polylabel.polylabel.PolylabelCollection","polylabel.polylabel.PolylabelObjectManager","ObjectManager"],function(t,e,o,a){function n(){var t=document.createElement("style");t.innerText="\n        .ymaps-polylabel-dot-default {\n            border: 1px solid rgba(255, 255, 255, 0.8);\n            height: 4px;\n            width: 4px;\n            border-radius: 3px;\n        }\n        .ymaps-polylabel-dot-default_hover {\n            border: 1px solid rgba(255, 255, 255, 1);\n        }\n        .ymaps-polylabel-label-default {\n            font-family: Arial, Helvetica, sans-serif;\n            text-align: center;\n        }\n        .ymaps-polylabel-dark-label {\n            color: #06264f;\n            -webkit-font-smoothing: subpixel-antialiased;\n            text-shadow:\n            0 -1px 0 rgba( 255, 255, 255, 0.4 ),\n            0 -1px 0 rgba( 255, 255, 255, 0.4 ),\n            0 1px 0 rgba( 255, 255, 255, 0.4 ),\n            0 1px 0 rgba( 255, 255, 255, 0.4 ),\n            -1px 0 0 rgba( 255, 255, 255, 0.4 ),\n            1px 0 0 rgba( 255, 255, 255, 0.4 ),\n            -1px 0 0 rgba( 255, 255, 255, 0.4 ),\n            1px 0 0 rgba( 255, 255, 255, 0.4 ),\n            -1px -1px 0 rgba( 255, 255, 255, 0.4 ),\n            1px -1px 0 rgba( 255, 255, 255, 0.4 ),\n            -1px 1px 0 rgba( 255, 255, 255, 0.4 ),\n            1px 1px 0 rgba( 255, 255, 255, 0.4 ),\n            -1px -1px 0 rgba( 255, 255, 255, 0.4 ),\n            1px -1px 0 rgba( 255, 255, 255, 0.4 ),\n            -1px 1px 0 rgba( 255, 255, 255, 0.4 ),\n            1px 1px 0 rgba( 255, 255, 255, 0.4 );\n            opacity: 0.9;\n        }\n        .ymaps-polylabel-light-label {\n            color: rgba(255, 255, 255, 1);\n            text-shadow: 0 0 2px rgba(0, 0, 0, 1), 0 0 2px rgba(0, 0, 0, 1);\n        }\n    ",document.head.appendChild(t)}t(function(t,l){return n(),l instanceof a?new o(t,l):new e(t,l)})}),ymaps.modules.define("polylabel.label.GeoObjectCollection.Label",["util.defineClass","vow","util.extend","Placemark","polylabel.label.util.LabelPlacemarkOverlay","polylabel.label.util.layoutTemplates.getBaseLayoutTemplates","polylabel.label.LabelBase"],function(t,e,o,a,n,l,i,s){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function s(e,o,a,n){r(this,s);var l=p(this,t.call(this));return l._map=e,l._polylabel=n,l._polygon=o,l._parentCollection=a,l._placemark={label:null,dot:null},l._layout={label:null,dot:null},l._init(),l}return e(s,t),s.prototype.removeFromCollection=function(){var t=this;this._parentCollection&&(["label","dot"].forEach(function(e){-1!==t._parentCollection.indexOf(t._placemark[e])&&t._parentCollection.remove(t._placemark[e])}),this._polygon=null,this._parentCollection=null,this._placemark=null,this._layout=null,this._data=null)},s.prototype.addToCollection=function(){var t=this;if(!this._parentCollection)return o.Promise.reject();var e=["label","dot"].map(function(e){return t._placemark[e].getParent()||t._parentCollection.add(t._placemark[e]),t.getLabelLayout(e).then(function(o){t.setLayout(e,o)})});return o.Promise.all(e)},s.prototype.getLabelLayout=function(t){return this._placemark[t].getOverlay().then(function(t){return t.getLayout()})},s.prototype._init=function(){this._baseLayoutTemplates=i()},s.prototype.createPlacemarks=function(){var t=this;["label","dot"].forEach(function(e){t._placemark[e]=s._createPlacemark({properties:a({},{polygon:t._polygon},t._polygon.properties.getAll()),options:t.getFormedOptionsForPlacemark(e)},t._baseLayoutTemplates[e],t._data.getCenterCoords(t._map.getZoom()))})},s._createPlacemark=function(t,e,o){var i=a({},{iconLayout:e,pointOverlay:l,iconLabelPosition:"absolute"},t.options);return new n(o,t.properties,i)},s.prototype.setDataByZoom=function(t,e){var o=this;["dot","label"].forEach(function(e){if("label"===e){var a=o._data.getStyles(t);o.setStyles({className:a.className,textSize:a.textSize,textColor:a.textColor})}o.setVisibilityForce("none"),o._data.setVisible(t,e,o._layout[e])});var a=this.setVisibility(e,this._data.getVisibility(t),this._data.getData("dotVisible")),n=this._data.getCenterCoords(t);return-1!==["label","dot"].indexOf(a)&&this._data.getSize(t,a)&&(this.setCoordinates(n),this.setOffsetAndIconShape(a,this._data.getSize(t,a),this._data.getOffset(t))),{currentVisibleType:a,currentConfiguredVisibileType:this._data.getVisibility(t),currentCenter:n}},s.prototype.setLayoutTemplate=function(){var t=this;this.createLayoutTemplates(),Object.keys(this._layoutTemplates).forEach(function(e){t._placemark[e].options.set(t._layoutTemplates[e])})},s.prototype.setNewOptions=function(t){var e=this;["dot","label"].forEach(function(o){e._placemark[o].options.set(t)})},s.prototype.setCoordinates=function(t){var e=this;t.toString()!==this._placemark.label.geometry.getCoordinates().toString()&&["dot","label"].forEach(function(o){e._placemark[o].geometry.setCoordinates(t)})},s.prototype.setVisibilityForce=function(t){var e=this;Object.keys(this._placemark).forEach(function(o){var a=e.analysePane(o,t);e._placemark[o].options.get("pane")!==a&&e._placemark[o].options.set({pane:a})})},s.prototype.setStyles=function(t){var e=this.analyseStyles(t);e.isChange&&this._placemark.label.options.set(e.styles)},s.prototype.setOffsetAndIconShape=function(t,e,o){var a=this.analyseOffset(e,o);this._placemark[t].options.set({iconShape:this.analyseShape(t,e,o),iconLabelLeft:a.left,iconLabelTop:a.top})},s.prototype.destroy=function(){this.removeFromCollection()},s}(s))}),ymaps.modules.define("polylabel.label.LabelBase",["vow","util.extend","polylabel.label.util.layoutTemplates.createLayoutTemplates","polylabel.label.util.LabelData","polylabel.label.util.classHelper","polylabel.label.util.getLayoutSize"],function(t,e,o,a,n,l,i){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(){s(this,t),this._baseLayoutTemplates=null,this._layoutTemplates=null}return t.prototype.getPolylabelType=function(){return this._polylabel.getPolylabelType()},t.prototype.getPlacemark=function(t){return this._placemark[t]},t.prototype.getLayout=function(t){return this._layout[t]},t.prototype.setLayout=function(t,e){this._layout[t]=e,this._initLayoutSizeChangeHandler(e)},t.prototype.updateLayouts=function(){var t=this;this.getLabelLayout("label").then(function(e){t.setLayout("label",e)}),this.getLabelLayout("dot").then(function(e){t.setLayout("dot",e)})},t.prototype._initLayoutSizeChangeHandler=function(t){var o=this,a=t.getElement();if(a){var n=Array.prototype.slice.call(a.getElementsByTagName("img"));n.length>0&&e.Promise.all(n.map(function(t){return t.complete?e.Promise.resolve():new e.Promise(function(e){return t.onload=e})})).then(function(){var e=i(t);e&&e.width>0&&e.height>0&&o._polylabel._setLabelData(o._polygon,o,void 0,["dot","label"])})}},t.prototype.getPolygonOptions=function(){return"collection"===this.getPolylabelType()?this._polygon.options.getAll():this._polygon.options},t.prototype.getLabelOptions=function(){var t=this._placemark.label;return"collection"===this.getPolylabelType()?t.options.getAll():t.options},t.prototype.getFormedOptionsForPlacemark=function(t){var e=this._data.getLabelCursors();return o({},this.getPolygonOptions(),this._layoutTemplates[t],e[t])},t.prototype.createLayoutTemplates=function(){var t=this.getPolygonOptions(),e=t.labelLayout,o=t.labelDotLayout;this._prevLayout&&this._prevLayout.dot===o&&this._prevLayout.label===e||(this._layoutTemplates=a(e,o),this._prevLayout={dot:o,label:e})},t.prototype.analyseVisibility=function(t,e,o){var a=t&&"auto"!==t?t:e;return"dot"!==a||o||(a="none"),a},t.prototype.setVisibility=function(t,e,o){var a=this.analyseVisibility(t,e,o);return this.setVisibilityForce(a),a},t.prototype.createLabelData=function(t,e){return this._data=new n(this._polygon,t,e,this._map,this),this._data},t.prototype.getLabelData=function(){return this._data},t.prototype.analysePane=function(t,e){return t===e?"places":"phantom"},t.prototype.analyseOffset=function(t,e){var o=t.height/2;return{left:-(t.width/2)+e[0],top:-o+e[1]}},t.prototype.analyseStyles=function(t){var e=this.getLabelOptions(),o=!1;return Object.keys(t).forEach(function(a){e["iconLabel"+a[0].toUpperCase()+a.slice(1)]!==t[a]&&(o=!0)}),{isChange:o,styles:{iconLabelClassName:t.className,iconLabelTextSize:t.textSize,iconLabelTextColor:t.textColor}}},t.prototype.analyseShape=function(t,e,o){var a=e.height/2,n=e.width/2,l="dot"===t&&this._data.isDotDefault?2:0;return{type:"Rectangle",coordinates:[[-n+o[0]-l,-a+o[1]-l],[n+o[0]+l,a+o[1]+l]]}},t.prototype.addDotClass=function(t){l.add(this._layout.dot,"ymaps-polylabel-dot-default",t)},t.prototype.removeDotClass=function(t){l.remove(this._layout.dot,"ymaps-polylabel-dot-default",t)},t}())}),ymaps.modules.define("polylabel.label.ObjectManager.Label",["util.defineClass","vow","util.extend","polylabel.label.util.LabelPlacemarkOverlay","polylabel.label.util.layoutTemplates.getBaseLayoutTemplates","polylabel.label.LabelBase"],function(t,e,o,a,n,l,i){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function i(e,o,a,n){s(this,i);var l=r(this,t.call(this));return l._map=e,l._polylabel=n,l._polygon=o,l._objectManager=a,l._placemark={label:null,dot:null},l._layout={label:null,dot:null},l._init(),l}return e(i,t),i.prototype.destroy=function(){this.removeFromObjectManager()},i.prototype.addToObjectManager=function(){var t=this;this.setLayoutTemplate(),["label","dot"].forEach(function(e){t._objectManager.add(t._placemark[e])})},i.prototype.removeFromObjectManager=function(){var t=this;["label","dot"].forEach(function(e){t._objectManager.remove(t._placemark[e])}),this._polygon=null,this._objectManager=null,this._placemark=null,this._layout=null,this._data=null},i.prototype._init=function(){this._baseLayoutTemplates=l()},i.prototype.getLabelLayout=function(t){var e=this._objectManager.objects.overlays.getById(this._placemark[t].id);return e?e.getLayout():o.Promise.reject()},i.prototype.createPlacemarks=function(){var t=this;["label","dot"].forEach(function(e){t._placemark[e]=i._createPlacemark(e+"#"+t._polygon.id,{properties:a({},{polygon:t._polygon},t._polygon.properties),options:t.getFormedOptionsForPlacemark(e)},t._baseLayoutTemplates[e],t._data.getCenterCoords(t._map.getZoom()))})},i._createPlacemark=function(t,e,o,l){return{type:"Feature",id:t,options:a({},{iconLayout:o,iconLabelPosition:"absolute",overlay:n,pane:"phantom"},e.options),properties:e.properties,geometry:{type:"Point",coordinates:l}}},i.prototype._updateOptions=function(t,e){this._objectManager.objects.setObjectOptions(t,e)},i.prototype.setLayoutTemplate=function(){var t=this;Object.keys(this._layoutTemplates).forEach(function(e){t._updateOptions(t._placemark[e].id,t._layoutTemplates[e])})},i.prototype.updateOptions=function(){var t=this;["dot","label"].forEach(function(e){a(t._placemark[e].options,t.getFormedOptionsForPlacemark(e)),t._updateOptions(t._placemark[e].id,t._placemark[e].options)})},i.prototype.setDataByZoom=function(t,e,o){var a=this;e.forEach(function(e){if("label"===e){var o=a._data.getStyles(t);a.setStyles({className:o.className,textSize:o.textSize,textColor:o.textColor})}a.setVisibilityForce("none"),a._data.setVisible(t,e,a._layout[e])});var n=this.setVisibility(o,this._data.getVisibility(t),this._data.getData("dotVisible")),l=this._data.getCenterCoords(t);return-1!==["label","dot"].indexOf(n)&&this._data.getSize(t,n)&&(this.setCoordinates(l),this.setOffsetAndIconShape(n,this._data.getSize(t,n),this._data.getOffset(t))),{currentVisibleType:n,currentConfiguredVisibileType:this._data.getVisibility(t),currentCenter:l}},i.prototype.setOffsetAndIconShape=function(t,e,o){var a=this.analyseOffset(e,o);this._updateOptions(this._placemark[t].id,{iconShape:this.analyseShape(t,e,o),iconLabelLeft:a.left,iconLabelTop:a.top})},i.prototype.setCoordinates=function(t){var e=this;t.toString()!==this._placemark.label.geometry.coordinates.toString()&&["dot","label"].forEach(function(o){e._objectManager.remove(e._placemark[o]),e._generateNewPlacemark(o),e._placemark[o].geometry.coordinates=t,e._objectManager.add(e._placemark[o])})},i.prototype.setStyles=function(t){var e=this.analyseStyles(t);e.isChange&&this._updateOptions(this._placemark.label.id,e.styles)},i.prototype.setVisibilityForce=function(t){var e=this;Object.keys(this._placemark).forEach(function(o){var a=e.analysePane(o,t),n=e._objectManager.objects.getById(e._placemark[o].id);n&&n.options.pane!==a&&e._updateOptions(e._placemark[o].id,{pane:a})})},i.prototype._generateNewPlacemark=function(t){this._placemark[t]=a({},this._placemark[t]);var e=this._placemark[t].id;this._placemark[t].id="_"===e[0]?e.slice(1):"_"+e},i}(i))}),ymaps.modules.define("polylabel.label.util.classHelper",[],function(t){function e(t,e){if(t){var o=t.getElement();if(o)return o.getElementsByClassName(e)[0]}}t({add:function(t,o,a){var n=e(t,o);n&&n.classList.add(a)},remove:function(t,o,a){var n=e(t,o);n&&n.classList.remove(a)}})}),ymaps.modules.define("polylabel.label.util.getLayoutSize",[],function(t){t(function(t){var e=t&&t.getElement();if(e&&(e=e.getElementsByClassName("ymaps-polylabel-view")[0])){var o=e.getBoundingClientRect();return{width:o.width,height:o.height}}})}),ymaps.modules.define("polylabel.label.util.LabelData",["polylabel.config","polylabel.util.zoom.parseZoomData","polylabel.util.getPolesOfInaccessibility","polylabel.util.zoom.setZoomVisibility","polylabel.util.transformPolygonCoords","polylabel.util.getPolygonWithMaxArea","polylabel.util.transformHexToRGB"],function(t,e,o,a,n,l,i,s){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var p=e.MIN_ZOOM,c=e.MAX_ZOOM,u=e.DEFAULT_POLYGON_FILL_COLOR,y=o({"1_6":12,"7_18":14});t(function(){function t(e,o,a,n,s){r(this,t),this._map=n,this._label=s,this._polygon=e,this._data={zoomInfo:{},autoCenter:[0,0],dotVisible:"boolean"!=typeof o.labelDotVisible||o.labelDotVisible},this.parsedOptions=t._parseOptions(a),this._polygonCoordsWithMaxArea=l.polygon(i(this.getPolygonCoords())),this.updateDotDefaultFlag(),this._init()}return t.prototype.setData=function(t,e){this._data[t]=e},t.prototype.getData=function(t){return this._data[t]},t.prototype.setZoomInfo=function(e,o,a){e=t.zoomRound(e),this._data.zoomInfo[e][o]=a},t.prototype.getZoomInfo=function(e){return(e=t.zoomRound(e))||"number"==typeof e&&0===e?this._data.zoomInfo[e]:this._data.zoomInfo},t.prototype.getPolygonCoords=function(){return"collection"===this._label.getPolylabelType()?this._polygon.geometry.getCoordinates():this._polygon.geometry.coordinates},t.prototype.getLabelCursors=function(){var t={dot:{},label:{}};return"collection"===this._label.getPolylabelType()?(t.label.cursor=this._polygon.options.get("labelCursor")||"grab",t.dot.cursor=this._polygon.options.get("labelDotCursor")||"grab"):(t.label.cursor=this._polygon.options.labelCursor||"grab",t.dot.cursor=this._polygon.options.labelDotCursor||"grab"),t},t.prototype.getLabelDefaults=function(t){var e="collection"===this._label.getPolylabelType()?this._polygon.options.get("labelDefaults"):this._polygon.options.labelDefaults;if(e)return{className:"dark"===e?"ymaps-polylabel-label-default ymaps-polylabel-dark-label":"ymaps-polylabel-label-default ymaps-polylabel-light-label",textSize:y[t]}},t.prototype.getCenterCoords=function(e){return e=t.zoomRound(e),this.parsedOptions.labelCenterCoords&&this.parsedOptions.labelCenterCoords[e]||this._data.autoCenter},t.prototype.getStyles=function(e){e=t.zoomRound(e);var o=this.getLabelDefaults(e);return o?{className:o.className,textSize:o.textSize}:{className:this.parsedOptions.labelClassName&&this.parsedOptions.labelClassName[e],textSize:this.parsedOptions.labelTextSize&&this.parsedOptions.labelTextSize[e],textColor:this.parsedOptions.labelTextColor&&this.parsedOptions.labelTextColor[e]}},t.prototype.getPolygonFillColor=function(){return("collection"===this._label.getPolylabelType()?this._polygon.options.get("fillColor"):this._polygon.options.fillColor)||u},t.prototype.getDotColorByPolygonColor=function(){var t=this.getPolygonFillColor(),e=s(t,.9);return e&&(t=e),t},t.prototype.getVisibility=function(e){return e=t.zoomRound(e),this.parsedOptions.labelForceVisible&&this.parsedOptions.labelForceVisible[e]||this._data.zoomInfo[e].visible},t.prototype.getOffset=function(e){return e=t.zoomRound(e),this.parsedOptions.labelOffset&&this.parsedOptions.labelOffset[e]||[0,0]},t.prototype.updateDotDefaultFlag=function(){this.isDotDefault=!this._label.getPolygonOptions().labelDotLayout},t.prototype.getPermissibleInaccuracyOfVisibility=function(e){return e=t.zoomRound(e),this.parsedOptions.labelPermissibleInaccuracyOfVisibility&&this.parsedOptions.labelPermissibleInaccuracyOfVisibility[e]||0},t.prototype.getSize=function(e,o){return e=t.zoomRound(e),this._data.zoomInfo[e][o+"Size"]},t.prototype.setSize=function(e,o,a){e=t.zoomRound(e),a.height>0&&a.width>0&&(this._data.zoomInfo[e][o+"Size"]=a)},t.zoomRound=function(t){return Math.round(t)},t.prototype.setVisible=function(e,o,a){if(e=t.zoomRound(e),!this.getSize(e,o)){var i=n(o,this._map,e,this._data.zoomInfo[e].visible,a,l.point(this.getCenterCoords(e),this._polygonCoordsWithMaxArea.isPositivePart),this._polygonCoordsWithMaxArea.coords,this.getOffset(e),this.getPermissibleInaccuracyOfVisibility(e));i&&(this._data.zoomInfo[e].visible=i.visible,this.setSize(e,o,i.size))}},t.prototype._checkParams=function(){if(!this._label.getPolygonOptions().labelLayout){var t="Не указан шаблон для подписи (labelLayout)";throw console.error(t),new Error(t)}},t.prototype._init=function(){this._checkParams();var e=a(this._polygonCoordsWithMaxArea.coords,1);this._data.autoCenter=e;for(var o=p;o<=c;o++)this._data.zoomInfo[o]=t._createDefaultZoomInfo(o)},t._parseOptions=function(t){var e={};return Object.keys(t).forEach(function(a){e[a]=o(t[a])}),e},t._createDefaultZoomInfo=function(){return{visible:"none",dotSize:void 0,labelSize:void 0}},t}())}),ymaps.modules.define("polylabel.label.util.LabelPlacemarkOverlay",["util.defineClass","overlay.Placemark","GeoObject"],function(t,e,o,a){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function o(e,a,i){return n(this,o),l(this,t.call(this,e,a,i))}return e(o,t),o.prototype.getData=function(){var t=this._data.geoObject instanceof a?this._data.geoObject.properties.get("polygon"):this._data.properties.polygon;return{geoObject:t,properties:t.properties,state:t.state}},o}(o))}),ymaps.modules.define("polylabel.label.util.layoutTemplates.createLayoutTemplates",["templateLayoutFactory"],function(t,e){t(function(t,o){return{label:{iconLabelTemplateLayout:e.createClass(t)},dot:{iconLabelDotTemplateLayout:e.createClass(o||'<div {% style %}\n        background-color: {{geoObject.options.fillColor|dot-color}};{% endstyle %}\n        class="ymaps-polylabel-dot-default"></div>')}}})}),ymaps.modules.define("polylabel.label.util.layoutTemplates.dotLayoutTemplate",["templateLayoutFactory"],function(t,e){t(e.createClass('<div class="ymaps-polylabel-view" {% style %}position: {{options.labelPosition}};\n        top: {{options.labelTop}}px; left: {{options.labelLeft}}px; {% endstyle %}>\n            {% include options.labelDotTemplateLayout %}\n    </div>'))}),ymaps.modules.define("polylabel.label.util.layoutTemplates.getBaseLayoutTemplates",["polylabel.label.util.layoutTemplates.labelLayoutTemplate","polylabel.label.util.layoutTemplates.dotLayoutTemplate"],function(t,e,o){t(function(){return{label:e,dot:o}})}),ymaps.modules.define("polylabel.label.util.layoutTemplates.labelLayoutTemplate",["templateLayoutFactory"],function(t,e){t(e.createClass('\n    <div class="ymaps-polylabel-view" {% style %}position: {{options.labelPosition}};\n        top: {{options.labelTop}}px; left: {{options.labelLeft}}px; {% endstyle %}>\n        <div class="{{options.labelClassName}}"\n            {% style %}font-size: {{options.labelTextSize}}px;\n            color: {{options.labelTextColor}}; {% endstyle %}>\n                {% include options.labelTemplateLayout %}\n        </div>\n    </div>'))}),ymaps.modules.define("polylabel.polylabel.PolylabelBase",["template.filtersStorage","polylabel.config","polylabel.util.templateFilterStorage.dotColor"],function(t,e,o,a){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(o){n(this,t),this._map=o,e.add("dot-color",a)}return t.prototype.getPolylabelType=function(){return this._polylabelType},t.prototype.initMapListeners=function(t){this._mapCallback=t,this._map.events.add(["boundschange","actionbegin","actionend"],this._mapEventsHandler,this)},t.prototype.destroyMapListeners=function(){this._map.events.remove(["boundschange","actionbegin","actionend"],this._mapEventsHandler,this)},t.prototype._mapEventsHandler=function(t){switch(t.get("type")){case"actionbegin":t.originalEvent.action.events.add("tick",this._actionTickHandler,this);break;case"actionend":t.originalEvent.action.events.remove("tick",this._actionTickHandler,this),this._zoomed&&(this._mapCallback("actionendzoomchange"),this._zoomed=!1)}},t.prototype._actionTickHandler=function(t){t.get("tick").zoom!==this._map.getZoom()&&(this._zoomed||this._mapCallback("actionbeginzoomchange"),this._zoomed=!0)},t.prototype.getOptions=function(t){return"collection"===this.getPolylabelType()?t.options.getAll():t.options},t.prototype.getConfigOptions=function(t){var e=this;return o.options.reduce(function(o,a){return o[a]="collection"===e.getPolylabelType()?t.options.get(a):t.options[a],o},{})},t.prototype.getConfigZoomRangeOptions=function(t){var e=this;return o.zoomRangeOptions.reduce(function(o,a){return o[a]="collection"===e.getPolylabelType()?t.options.get(a):t.options[a],o},{})},t.prototype.getConfigProperties=function(t){var e=this;return o.properties.reduce(function(o,a){return o[a]="collection"===e.getPolylabelType()?t.properties.get(a):t.properties[a],o},{})},t}())}),ymaps.modules.define("polylabel.polylabel.PolylabelCollection",["util.defineClass","util.WeakMap","vow","GeoObjectCollection","Monitor","system.nextTick","event.Manager","Event","polylabel.polylabel.PolylabelBase","polylabel.label.GeoObjectCollection.Label","polylabel.util.State"],function(t,e,o,a,n,l,i,s,r,p,c,u){function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function p(e,a){y(this,p);var l=b(this,t.call(this,e));return l._map=e,l._labelsCollection=new n,l._labelsState=new u,l._userState=new u,l._polygonsCollection=a,l._isPolygonParentChange=new o,l._polylabelType="collection",l._init(),l}return e(p,t),p.prototype.destroy=function(){this._deleteLabelStateListeners(),this._deletePolygonsListeners(),this._deletePolygonCollectionListeners(),this._deleteLabelCollection(),this._map.geoObjects.remove(this._labelsCollection)},p.prototype.getLabelState=function(t){return this._userState.getState(t)},p.prototype._init=function(){var t=this;this._map.geoObjects.add(this._labelsCollection),this._firstCalculatePolygons().then(function(){t._initMapListeners(),t._initPolygonCollectionListeners(),t._initLabelCollectionListeners()})},p.prototype._firstCalculatePolygons=function(){var t=this;return this._clearLabelCollection(),this._polygonsCollection.each(function(e){t._calculateNewPolygon(e).then(function(o){t._setLabelData(e,o)})}),a.Promise.resolve()},p.prototype._calculatePolygons=function(){var t=this,e=[];return this._polygonsCollection.each(function(o){if("Polygon"===o.geometry.getType()){var a=t._labelsState.get(o,"label");a&&e.push(t._setLabelData(o,a))}}),a.Promise.all(e)},p.prototype._clearLabelCollection=function(){this._labelsCollection.removeAll(),this._labelsCollection.options.set({pane:"phantom"})},p.prototype._deleteLabelCollection=function(){var t=this;this._polygonsCollection.each(function(e){var o=t._labelsState.get(e,"label");o&&o.destroy()}),this._clearLabelCollection()},p.prototype._calculatePolygonLabelData=function(t,e){var o=this.getConfigOptions(t),n=this.getConfigZoomRangeOptions(t),l=e?this._labelsState.get(t,"label"):new c(this._map,t,this._labelsCollection,this);return l.createLabelData(o,n),l.createLayoutTemplates(),a.Promise.resolve(l)},p.prototype._setLabelData=function(t,e,o){var a=e.setDataByZoom(this._map.getZoom(),o);this._setCurrentConfiguredVisibility(t,a.currentConfiguredVisibileType),this._setCurrentVisibility(t,a.currentVisibleType),this._setCurrentCenter(t,a.currentCenter)},p.prototype._setCurrentCenter=function(t,e){this._userState.set(t,"center",e)},p.prototype._setCurrentConfiguredVisibility=function(t,e){this._userState.set(t,"currentConfiguredVisibility",e)},p.prototype._setCurrentVisibility=function(t,e){this._userState.set(t,"currentVisibility",-1!==["dot","label"].indexOf(e)?e:"none")},p.prototype._calculateNewPolygon=function(t){var e=this;return"Polygon"!==t.geometry.getType()?a.Promise.reject():new a.Promise(function(o){e._calculatePolygonLabelData(t).then(function(a){e._labelsState.set(t,"label",a),e._initUserStateListener(t),e._initPolygonListener(t),a.createPlacemarks(),a.addToCollection().then(function(){o(a)})})})},p.prototype._clearVisibilityInLabelsState=function(t){var e=this;this._polygonsCollection.each(function(o){e._userState.set(o,"visible",t)})},p.prototype._initUserStateListener=function(t){var e=this,o=new l(this._userState.getState(t));this._userState.set(t,"_labelMonitor",o),o.add("visible",function(o){e._setLabelData(t,e._labelsState.get(t,"label"),o)})},p.prototype._initPolygonListener=function(t){"Polygon"===t.geometry.getType()&&(t.events.add(["optionschange","propertieschange"],this._onPolygonOptionsChangeHandler,this),t.events.add("parentchange",this._onPolygonParentChangeHandler,this))},p.prototype._onPolygonParentChangeHandler=function(t){this._isPolygonParentChange.set(t.get("target"),!0)},p.prototype._onPolygonOptionsChangeHandler=function(t){var e=this;i(function(){var o=t.get("target"),a=e._labelsState.get(o,"label");!e._isPolygonParentChange.get(o)&&a&&(a.setVisibilityForce("none"),a.setLayoutTemplate(),e._calculatePolygonLabelData(o,!0).then(function(t){t.updateLayouts(),e._labelsState.set(o,"label",t),e._setLabelData(o,t)}))})},p.prototype._initPolygonCollectionListeners=function(){this._polygonsCollection.events.add(["add","remove"],this._polygonCollectionEventHandler,this)},p.prototype._polygonCollectionEventHandler=function(t){var e=this;switch(t.get("type")){case"add":var o=t.get("child");this._calculateNewPolygon(o).then(function(t){e._setLabelData(o,t)});break;case"remove":var a=t.get("child");this._deleteLabelStateListener(a);var n=this._labelsState.get(a,"label");n&&n.destroy()}},p.prototype._initLabelCollectionListeners=function(){var t=this,e=new s({controllers:[{onBeforeEventFiring:function(e,o,a){if("phantom"===a.get("target").options.get("pane"))return!1;var n=a.get("target").properties.get("polygon");if(!n)return!1;if("mouseenter"===o||"mouseleave"===o){var l=t._labelsState.get(n,"label");l&&l.getLabelData().isDotDefault&&("mouseenter"===o?l.addDotClass("ymaps-polylabel-dot-default_hover"):l.removeDotClass("ymaps-polylabel-dot-default_hover"))}var i=new r({target:n,type:"label"+o},a);return n.events.fire("label"+o,i),!1}}]});this._labelsCollection.events.setParent(e)},p.prototype._initMapListeners=function(){var t=this;this.initMapListeners(function(e){"actionendzoomchange"===e?(t._clearVisibilityInLabelsState(),t._calculatePolygons()):"actionbeginzoomchange"===e&&t._clearVisibilityInLabelsState("none")})},p.prototype._deleteLabelStateListeners=function(){var t=this;this._polygonsCollection.each(function(e){t._deleteLabelStateListener(e)})},p.prototype._deleteLabelStateListener=function(t){var e=this._userState.get(t,"_labelMonitor");e&&e.removeAll()},p.prototype._deletePolygonCollectionListeners=function(){this._polygonsCollection.events.remove(["add","remove"],this._polygonCollectionEventHandler,this),this.destroyMapListeners()},p.prototype._deletePolygonsListeners=function(){var t=this;this._polygonsCollection.each(function(e){t._deletePolygonListener(e)})},p.prototype._deletePolygonListener=function(t){t.events.remove(["optionschange","propertieschange"],this._onPolygonOptionsChangeHandler,this),t.events.remove("parentchange",this._onPolygonParentChangeHandler,this)},p}(p))}),ymaps.modules.define("polylabel.polylabel.PolylabelObjectManager",["util.defineClass","vow","Monitor","ObjectManager","system.nextTick","event.Manager","polylabel.polylabel.PolylabelBase","polylabel.label.ObjectManager.Label","polylabel.util.State"],function(t,e,o,a,n,l,i,s,r,p){function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}t(function(t){function s(e,o){c(this,s);var a=u(this,t.call(this,e));return a._map=e,a._polygonsObjectManager=o,a._labelsObjectManager=new n,a._labelsState=new p,a._userState=new p,a._polylabelType="objectmanager",a._init(),a}return e(s,t),s.prototype.destroy=function(){this._deleteLabelsOverlaysListeners(),this._deleteLabelStateListeners(),this._deletePolygonsListeners(),this._deletePolygonsObjectsListeners(),this._deleteLabelsOMListeners()},s.prototype.getLabelState=function(t){return this._userState.getState(t)},s.prototype._init=function(){var t=this;this._map.geoObjects.add(this._labelsObjectManager),this._initLabelsOverlaysListeners(),this._initPolygonsObjectsListeners(),this._initPolygonsListeners(),this._initLabelsOMListeners(),this._calculatePolygons().then(function(){return t._initMapListeners()})},s.prototype._calculatePolygons=function(){var t=this;return this._polygonsObjectManager.objects.each(function(e){t._calculateNewPolygon(e)}),o.Promise.resolve()},s.prototype._calculatePolygonLabelData=function(t,e){var a=this.getConfigOptions(t),n=this.getConfigZoomRangeOptions(t),l=e?this._labelsState.get(t,"label"):new r(this._map,t,this._labelsObjectManager,this);return l.createLabelData(a,n),l.createLayoutTemplates(),o.Promise.resolve(l)},s.prototype._setLabelData=function(t,e,o,a){var n=e.setDataByZoom(this._map.getZoom(),a,o);this._setCurrentConfiguredVisibility(t,n.currentConfiguredVisibileType),this._setCurrentVisibility(t,n.currentVisibleType),this._setCurrentCenter(t,n.currentCenter)},s.prototype._setCurrentCenter=function(t,e){this._userState.set(t,"center",e)},s.prototype._setCurrentConfiguredVisibility=function(t,e){this._userState.set(t,"currentConfiguredVisibility",e)},s.prototype._setCurrentVisibility=function(t,e){this._userState.set(t,"currentVisibility",-1!==["dot","label"].indexOf(e)?e:"none")},s.prototype._initLabelStateListener=function(t){var e=this,o=new a(this._userState.getState(t));this._userState.set(t,"_labelMonitor",o),o.add("visible",function(o){t&&e._setLabelData(t,e._labelsState.get(t,"label"),o,["dot","label"])})},s.prototype._initLabelsOverlaysListeners=function(){this._labelsObjectManager.objects.overlays.events.add(["add","remove"],this._labelsOverlaysEventHandler,this)},s.prototype._getLabelType=function(t){return-1!==t.indexOf("label#")?"label":"dot"},s.prototype._labelOverlaysGeometryChangeHandler=function(t){var e=this,o=t.get("target"),a=o._data.id;o.getLayout().then(function(t){var o=e._getLabelType(a),n=e._labelsObjectManager.objects.getById(a);if(n){var l=n.properties.polygon,i=e._labelsState.get(l,"label");i.setLayout(o,t),e._setLabelData(l,i,void 0,[o])}})},s.prototype._labelsOverlaysEventHandler=function(t){var e=this,o=t.get("objectId"),a=this._getLabelType(o),n=t.get("overlay");switch(t.get("type")){case"add":n.events.add("geometrychange",this._labelOverlaysGeometryChangeHandler,this),l(function(){n&&n.getLayout().then(function(t){if(t){var n=e._labelsObjectManager.objects.getById(o);if(n){var l=n.properties.polygon,i=e._labelsState.get(l,"label");i.setLayout(a,t),e._setLabelData(l,i,void 0,[a])}}})});break;case"remove":n.events.remove("geometrychange",this._labelOverlaysGeometryChangeHandler,this)}},s.prototype._clearVisibilityInLabelsState=function(t){var e=this;this._polygonsObjectManager.objects.each(function(o){e._userState.set(o,"visible",t)})},s.prototype._initMapListeners=function(){var t=this;this.initMapListeners(function(e){"actionendzoomchange"===e?t._clearVisibilityInLabelsState():"actionbeginzoomchange"===e&&t._clearVisibilityInLabelsState("none")})},s.prototype._initPolygonsObjectsListeners=function(){this._polygonsObjectManager.objects.events.add(["add","remove"],this._polygonCollectionEventHandler,this)},s.prototype._polygonCollectionEventHandler=function(t){switch(t.get("type")){case"add":var e=t.get("child");this._calculateNewPolygon(e);break;case"remove":var o=t.get("child");this._deleteLabelStateListener(o);var a=this._labelsState.get(o,"label");a&&a.destroy()}},s.prototype._calculateNewPolygon=function(t){var e=this;"Polygon"===t.geometry.type&&this._calculatePolygonLabelData(t).then(function(o){e._labelsState.set(t,"label",o),e._initLabelStateListener(t),o.createPlacemarks(),o.addToObjectManager()})},s.prototype._initPolygonsListeners=function(){this._polygonsObjectManager.objects.events.add(["optionschange","objectoptionschange"],this._onPolygonOptionsChangeHandler,this)},s.prototype._onPolygonOptionsChangeHandler=function(t){var e=this,o=this._polygonsObjectManager.objects.getById(t.get("objectId"));o&&this._calculatePolygonLabelData(o,!0).then(function(t){t.setVisibilityForce("none"),e._labelsState.set(o,"label",t),t.setLayoutTemplate(),t.updateOptions(),t.updateLayouts(),e._setLabelData(o,e._labelsState.get(o,"label"),void 0,["dot","label"])})},s.prototype._initLabelsOMListeners=function(){var t=this,e=new i({controllers:[{onBeforeEventFiring:function(e,o,a){var n=a.get("objectId");if(!n)return!1;var l=n.split("#")[1];l=isNaN(Number(l))?l:Number(l);var i=t._polygonsObjectManager.objects.getById(l),s=t._labelsObjectManager.objects.getById(n);if(s&&"phantom"===s.options.pane||!i)return!1;if("mouseenter"===o||"mouseleave"===o){var r=t._labelsState.get(i,"label");r&&r.getLabelData().isDotDefault&&("mouseenter"===o?r.addDotClass("ymaps-polylabel-dot-default_hover"):r.removeDotClass("ymaps-polylabel-dot-default_hover"))}return t._polygonsObjectManager.events.fire("label"+o,{objectId:l,type:"label"+o}),!1}}]});this._labelsObjectManager.events.setParent(e)},s.prototype._deleteLabelStateListeners=function(){var t=this;this._polygonsObjectManager.objects.each(function(e){"Polygon"===e.geometry.type&&t._deleteLabelStateListener(e)})},s.prototype._deleteLabelStateListener=function(t){var e=this._userState.get(t,"_labelMonitor");e&&e.removeAll()},s.prototype._deleteLabelsOverlaysListeners=function(){this._labelsObjectManager.objects.overlays.events.remove(["add","remove"],this._labelsOverlaysEventHandler,this)},s.prototype._deletePolygonsListeners=function(){this._polygonsObjectManager.objects.events.remove(["optionschange","objectoptionschange"],this._onPolygonOptionsChangeHandler,this)},s.prototype._deletePolygonsObjectsListeners=function(){this._polygonsObjectManager.objects.events.remove(["add","remove"],this._polygonCollectionEventHandler,this),this.destroyMapListeners()},s.prototype._deleteLabelsOMListeners=function(){var t=this;this._polygonsObjectManager.objects.each(function(e){var o=t._labelsState.get(e,"label");"Polygon"===e.geometry.type&&o&&o.destroy()}),this._clearLabels()},s.prototype._clearLabels=function(){this._labelsObjectManager.removeAll()},s}(s))}),ymaps.modules.define("polylabel.util.checkPointPosition",[],function(t){function e(t,e,l){var i=o(l,e),s=o(t,e),r=i[0]*s[1]-s[0]*i[1];return r>0?"LEFT":r<0?"RIGHT":i[0]*s[0]<0||i[1]*s[1]<0?"BEHIND":a(i)<a(s)?"BEYOND":n(e,t)?"ORIGIN":n(l,t)?"DESTINATION":"BETWEEN"}function o(t,e){return[t[0]-e[0],t[1]-e[1]]}function a(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function n(t,e){return t[0]===e[0]&&t[1]===e[1]}function l(t,o){var a=o[0],n=o[1];switch(e(t,a,n)){case"LEFT":return a[1]<t[1]&&t[1]<=n[1]?"CROSSING":"INESSENTIAL";case"RIGHT":return n[1]<t[1]&&t[1]<=a[1]?"CROSSING":"INESSENTIAL";case"BETWEEN":case"ORIGIN":case"DESTINATION":return"TOUCHING";default:return"INESSENTIAL"}}t(function(t,e){for(var o=0,a=0;a<e.length-1;a++)switch(l(t,[e[a],e[a+1]])){case"TOUCHING":return"BOUNDARY";case"CROSSING":o=1-o}return o?"INSIDE":"OUTSIDE"})}),ymaps.modules.define("polylabel.util.getPolesOfInaccessibility",[],function(t){function e(t,a){if(!(this instanceof e))return new e(t,a);if(this.data=t||[],this.length=this.data.length,this.compare=a||o,this.length>0)for(var n=this.length>>1;n>=0;n--)this._down(n)}function o(t,e){return t<e?-1:t>e?1:0}function a(t,e,o){e=e||1;for(var a,i,r,c,u=0;u<t[0].length;u++){var y=t[0][u];(!u||y[0]<a)&&(a=y[0]),(!u||y[1]<i)&&(i=y[1]),(!u||y[0]>r)&&(r=y[0]),(!u||y[1]>c)&&(c=y[1])}var b=r-a,h=c-i,f=Math.min(b,h),d=f/2,g=new p(null,n);if(0===f)return[a,i];for(var _=a;_<r;_+=f)for(var m=i;m<c;m+=f)g.push(new l(_+d,m+d,d,t));var v=s(t),L=new l(a+b/2,i+h/2,0,t);L.d>v.d&&(v=L);for(var C=g.length;g.length;){var O=g.pop();O.d>v.d&&(v=O,o&&console.error("found best %d after %d probes",Math.round(1e4*O.d)/1e4,C)),O.max-v.d<=e||(d=O.h/2,g.push(new l(O.x-d,O.y-d,d,t)),g.push(new l(O.x+d,O.y-d,d,t)),g.push(new l(O.x-d,O.y+d,d,t)),g.push(new l(O.x+d,O.y+d,d,t)),C+=4)}return o&&(console.error("num probes: "+C),console.error("best distance: "+v.d)),[v.x,v.y]}function n(t,e){return e.max-t.max}function l(t,e,o,a){this.x=t,this.y=e,this.h=o,this.d=i(t,e,a),this.max=this.d+this.h*Math.SQRT2}function i(t,e,o){for(var a=!1,n=1/0,l=0;l<o.length;l++)for(var i=o[l],s=0,p=i.length,c=p-1;s<p;c=s++){var u=i[s],y=i[c];u[1]>e!=y[1]>e&&t<(y[0]-u[0])*(e-u[1])/(y[1]-u[1])+u[0]&&(a=!a),n=Math.min(n,r(t,e,u,y))}return(a?1:-1)*Math.sqrt(n)}function s(t){for(var e=0,o=0,a=0,n=t[0],i=0,s=n.length,r=s-1;i<s;r=i++){var p=n[i],c=n[r],u=p[0]*c[1]-c[0]*p[1];o+=(p[0]+c[0])*u,a+=(p[1]+c[1])*u,e+=3*u}return 0===e?new l(n[0][0],n[0][1],0,t):new l(o/e,a/e,0,t)}function r(t,e,o,a){var n=o[0],l=o[1],i=a[0]-n,s=a[1]-l;if(0!==i||0!==s){var r=((t-n)*i+(e-l)*s)/(i*i+s*s);r>1?(n=a[0],l=a[1]):r>0&&(n+=i*r,l+=s*r)}return i=t-n,s=e-l,i*i+s*s}t(function(t,e,o){return a([t],e,o)}),e.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return--this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,o=this.compare,a=e[t];t>0;){var n=t-1>>1,l=e[n];if(o(a,l)>=0)break;e[t]=l,t=n}e[t]=a},_down:function(t){for(var e=this.data,o=this.compare,a=this.length>>1,n=e[t];t<a;){var l=1+(t<<1),i=l+1,s=e[l];if(i<this.length&&o(e[i],s)<0&&(l=i,s=e[i]),o(s,n)>=0)break;e[t]=s,t=l}e[t]=n}};var p=e}),ymaps.modules.define("polylabel.util.getPolygonWithMaxArea",["util.calculateArea","GeoObject"],function(t,e,o){t(function(t){if(void 0===e)throw new Error("Didn't find calculateArea module");for(var a=Number.MIN_VALUE,n=0,l=0;l<t.length;l++){var i=new o({geometry:{type:"Polygon",coordinates:[t[l]]}}),s=Math.round(e(i));a<s&&(a=s,n=l)}return t[n]})}),ymaps.modules.define("polylabel.util.State",["util.WeakMap","data.Manager"],function(t,e,o){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t(function(){function t(){a(this,t),this._state=new e}return t.prototype._getDataManager=function(t){var e=this._state.get(t);return e||(e=new o,this._state.set(t,e)),e},t.prototype.set=function(t,e,o){this._getDataManager(t).set(e,o)},t.prototype.get=function(t,e){var o=this._getDataManager(t);if(o)return o.get(e)},t.prototype.getState=function(t){return this._getDataManager(t)},t}())}),ymaps.modules.define("polylabel.util.templateFilterStorage.dotColor",["polylabel.util.transformHexToRGB","polylabel.config"],function(t,e,o){t(function(t,a){return e(a||o.DEFAULT_POLYGON_FILL_COLOR,.9)})}),ymaps.modules.define("polylabel.util.transformHexToRGB",[],function(t){t(function(t,e){if(t){if(-1!==t.indexOf("rgb"))return t;t=(t="#"!==t[0]?"#"+t:t).slice(0,7);var o=void 0;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3===(o=t.substring(1).split("")).length&&(o=[o[0],o[0],o[1],o[1],o[2],o[2]]),o="0x"+o.join(""),"rgba("+[o>>16&255,o>>8&255,255&o].join(",")+", "+(e||1)+")"}})}),ymaps.modules.define("polylabel.util.transformPolygonCoords",[],function(t){function e(t,e,o){return t?a(e,o):n(e,o)}function o(t){return[{key:"180",distance:180-t[1]},{key:"-180",distance:Math.abs(-180-t[1])},{key:"0",distance:Math.abs(t[1])}].sort(l)[0].key}function a(t,e){return"-180"===t?[e[0],360+e[1]]:e}function n(t,e){return"180"===t?[e[0],-360+e[1]]:e}function l(t,e){return t.distance-e.distance}t({polygon:function(t){for(var a=[],n=!0,l=0;l<t.length;l++){var i=t[l];0===l&&(n=i[1]>=0);var s=o(i);a.push(e(n,s,i))}return{coords:a,isPositivePart:n}},point:function(t,a){return e(a,o(t),t)}})}),ymaps.modules.define("polylabel.util.zoom.getFirstZoomInside",["polylabel.util.checkPointPosition","polylabel.config"],function(t,e,o){function a(t,e,o,a,n,l){var i=t.options.get("projection").toGlobalPixels(e,o),s=a.width,r=a.height;i[0]+=n[0],i[1]+=n[1];var p=[],c=[];return p.push([i[0]-s/2,i[1]-r/2],[i[0]-s/2,i[1]+r/2],[i[0]+s/2,i[1]-r/2],[i[0]+s/2,i[1]+r/2]),c.push([p[0][0]+l>i[0]?i[0]:p[0][0]+l,p[0][1]+l>i[1]?i[1]:p[0][1]+l],[p[1][0]+l>i[0]?i[0]:p[1][0]+l,p[1][1]-l<i[1]?i[1]:p[1][1]-l],[p[2][0]-l<i[0]?i[0]:p[2][0]-l,p[2][1]+l>i[1]?i[1]:p[2][1]+l],[p[3][0]-l<i[0]?i[0]:p[3][0]-l,p[3][1]-l<i[1]?i[1]:p[3][1]-l]),{normal:p,withInaccuracy:c}}function n(t,o,a,n){for(var l=0;l<a.length;l++){var i=t.options.get("projection").fromGlobalPixels(a[l],n);if("INSIDE"!==e(i,o))return!1}return!0}t(function(t,e,l,i,s,r){for(var p=o.MIN_ZOOM,c=o.MAX_ZOOM,u=void 0;p<c;){u=Math.floor((p+c)/2);var y=isNaN(Number(r))?0:Number(r),b=a(t,e,u,i,s||[0,0],y);n(t,l,b.normal,u)||0!==y&&n(t,l,b.withInaccuracy,u)?c=u:p=u+1}return p})}),ymaps.modules.define("polylabel.util.zoom.parseZoomData",["util.array","polylabel.config"],function(t,e,o){function a(t,e,o){t[e]=o}function n(t,e,o){if(isNaN(Number(e))){var a=e.split("_").map(Number);if(!isNaN(a[0])&&!isNaN(a[1]))for(var n=a[0]<s?s:a[0],l=a[1]>r?r:a[1];n<=l;)t[n]=o,n++}else t[Number(e)]=o}function l(t){for(var e={},o=s;o<=r;o++)e[o]=t;return e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=o.MIN_ZOOM,r=o.MAX_ZOOM;t(function(t){var o=["number","string","boolean","object"];return t&&!e.isArray(t)&&"object"===(void 0===t?"undefined":i(t))?Object.keys(t).reduce(function(e,o){return"string"==typeof o?n(e,o,t[o]):"number"==typeof o&&a(e,o,t[o]),e},l()):o.includes(void 0===t?"undefined":i(t))?l(t):void 0})}),ymaps.modules.define("polylabel.util.zoom.setZoomVisibility",["polylabel.util.zoom.getFirstZoomInside","polylabel.label.util.getLayoutSize"],function(t,e,o){function a(t,e,o){var a=["none","dot","label"],n=t;return o&&(n=a.indexOf(e)>a.indexOf(t)?e:t),n}function n(t,n,l,i,s,r,p,c,u){var y=o(s);if(y&&0!==y.width&&0!==y.height)return{visible:a(i,t,l>=e(n,r,p,y,c,"dot"===t?0:u)),size:y}}t(function(t,e,o,a,l,i,s,r,p){return n(t,e,o,a,l,i,s,r,p)})});