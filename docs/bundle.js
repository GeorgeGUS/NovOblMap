!function(t){var o={};function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(e,n,t){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(n,e){if(1&e&&(n=a(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var o in n)a.d(t,o,function(e){return n[e]}.bind(null,o));return t},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,"a",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p="",a(a.s=9)}([function(e,n,t){"use strict";t.d(n,"a",function(){return o});var o={convertCoords:function(e){var n=myMap.options.get("projection");return myMap.converter.globalToPage(n.toGlobalPixels(e,myMap.getZoom()))},convertPixels:function(e){return myMap.options.get("projection").fromGlobalPixels(myMap.converter.pageToGlobal(e),myMap.getZoom())},delay:function(t,o){return function(){var e=this,n=arguments;setTimeout(function(){t.apply(e,n)},o)}},serialAsyncMap:function(e,n){var t=[],o=Promise.resolve(),a=!0,r=!1,c=void 0;try{for(var i,s=function(){var e=i.value;o=o.then(function(){return n(e)}).then(function(e){return t.push(e)})},u=e[Symbol.iterator]();!(a=(i=u.next()).done);a=!0)s()}catch(e){r=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(r)throw c}}return o.then(function(){return t})}}},function(e,n,t){"use strict";function o(e,n){var t={"Великий Новгород":"pin-vn","Залучье":"pin-zl","Пролетарий":"pin-pr","Боровичи":"pin-br"},o=n?"active":"";if(n){var a=!0,r=!1,c=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){f=i.value;pinsObject.objects.getById(f.name).properties.activeClass=o}}catch(e){r=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw c}}myMap.geoObjects.add(pinsObject)}else{var u={type:"FeatureCollection",features:[]},l=!0,m=!1,h=void 0;try{for(var d,p=e[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f,y=t[(f=d.value).ceh],v=f.ceh===f.name?"pin-main":"";u.features.push({type:"Feature",id:f.name,geometry:{type:"Point",coordinates:[f.lat,f.len]},properties:{activeClass:o,iconClass:y,mainClass:v,pinLabel:f.name}})}}catch(e){m=!0,h=e}finally{try{l||null==p.return||p.return()}finally{if(m)throw h}}pinsObject.add(u),pinsObject.objects.options.set({mainClass:v,iconLayout:ymaps.templateLayoutFactory.createClass('<div class="pin $[properties.iconClass] $[properties.mainClass] $[properties.activeClass]">\n          {{ properties.pinLabel }}\n        </div>')}),myMap.geoObjects.add(pinsObject),console.log("Метки загружены")}}t.d(n,"a",function(){return o})},function(e,n,t){"use strict";t.d(n,"a",function(){return o});var o=[{ceh:"Боровичи",name:"Анциферово",lat:58.966335,len:34.024697,ch1mux:26,ch2mux:46},{ceh:"Великий Новгород",name:"Батецкий",lat:58.64474,len:30.301729,ch1mux:43,ch2mux:44},{ceh:"Боровичи",name:"Ближнее Заполье",lat:59.104938,len:33.30397,ch1mux:26,ch2mux:46},{ceh:"Боровичи",name:"Боровичи",lat:58.388219,len:33.914025,ch1mux:26,ch2mux:46},{ceh:"Пролетарий",name:"Яжелбицы",lat:58.036126,len:32.959888,ch1mux:51,ch2mux:57},{ceh:"Пролетарий",name:"Валдай",lat:57.980199,len:33.246667,ch1mux:51,ch2mux:57},{ceh:"Великий Новгород",name:"Великий Новгород",lat:58.52281,len:31.269915,ch1mux:30,ch2mux:58},{ceh:"Боровичи",name:"Висленев Остров",lat:58.701964,len:33.08559,ch1mux:26,ch2mux:46},{ceh:"Великий Новгород",name:"Волот",lat:57.927807,len:30.70677,ch1mux:40,ch2mux:29},{ceh:"Великий Новгород",name:"Воронино",lat:58.565688,len:30.597032,ch1mux:43,ch2mux:44},{ceh:"Боровичи",name:"Кабожа",lat:58.803774,len:35.028403,ch1mux:51,ch2mux:57},{ceh:"Боровичи",name:"Лубенское",lat:58.629409,len:35.108937,ch1mux:51,ch2mux:57},{ceh:"Боровичи",name:"Глухачи",lat:58.614241,len:35.422108,ch1mux:51,ch2mux:57},{ceh:"Залучье",name:"Залучье",lat:57.667865,len:31.765021,ch1mux:51,ch2mux:57},{ceh:"Залучье",name:"Ильина Гора",lat:57.581332,len:32.652665,ch1mux:51,ch2mux:57},{ceh:"Боровичи",name:"Калитино",lat:58.93598,len:33.411031,ch1mux:26,ch2mux:46},{ceh:"Залучье",name:"Лычково",lat:57.921493374063736,len:32.423002282538064,ch1mux:51,ch2mux:57},{ceh:"Боровичи",name:"Любытино",lat:58.815748,len:33.393892,ch1mux:26,ch2mux:46},{ceh:"Пролетарий",name:"Малая Вишера",lat:58.845758,len:32.217664,ch1mux:30,ch2mux:58},{ceh:"Пролетарий",name:"Мелехово",lat:59.098917,len:31.935737,ch1mux:30,ch2mux:58},{ceh:"Пролетарий",name:"Мокрый Остров",lat:58.187197,len:32.487518,ch1mux:51,ch2mux:57},{ceh:"Боровичи",name:"Мошенское",lat:58.511464,len:34.593187,ch1mux:26,ch2mux:46},{ceh:"Пролетарий",name:"Новинка",lat:57.801658,len:33.082419,ch1mux:51,ch2mux:57},{ceh:"Великий Новгород",name:"Новое Овсино",lat:58.491838,len:30.28935,ch1mux:43,ch2mux:44},{ceh:"Залучье",name:"Переходы",lat:57.665208,len:30.867281,ch1mux:40,ch2mux:29},{ceh:"Боровичи",name:"Пестово",lat:58.595347,len:35.800685,ch1mux:51,ch2mux:57},{ceh:"Залучье",name:"Полново",lat:57.534352,len:32.948273,ch1mux:51,ch2mux:57},{ceh:"Пролетарий",name:"Пролетарий",lat:58.437358,len:31.708167,ch1mux:30,ch2mux:58},{ceh:"Великий Новгород",name:"Старая Каменка",lat:58.208834,len:30.093733,ch1mux:40,ch2mux:29},{ceh:"Залучье",name:"Старая Русса",lat:58.00852713133914,len:31.359131990765995,ch1mux:51,ch2mux:57},{ceh:"Великий Новгород",name:"Тёсовский",lat:58.791396,len:30.875761,ch1mux:30,ch2mux:58},{ceh:"Залучье",name:"Тугино",lat:57.409961,len:31.048947,ch1mux:23,ch2mux:24},{ceh:"Боровичи",name:"Угловка",lat:58.214007,len:33.517688,ch1mux:26,ch2mux:46},{ceh:"Боровичи",name:"Хвойная",lat:58.896645,len:34.491507,ch1mux:26,ch2mux:46},{ceh:"Залучье",name:"Холм",lat:57.145202,len:31.178781,ch1mux:23,ch2mux:24}]},function(e,n){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,n,t){"use strict";function o(){ymaps.borders.load("RU",{quality:2}).then(function(e){var n=e.features[32];n.id=n.properties.iso3166,n.options={strokeWidth:4,strokeColor:"#ff4500",strokeOpacity:.6,fillColor:"#ffd530",fillOpacity:.4,openHintOnHover:!1};var t=new ymaps.ObjectManager;t.add(n),myMap.geoObjects.add(t);var o=n.geometry.coordinates[0],a=ymaps.util.bounds.fromPoints(o);ymaps.util.requireCenterAndZoom(myMap.getType(),a,myMap.container.getSize(),{margin:5,preciseZoom:!0}).then(function(e){myMap.setCenter(e.center,e.zoom);var n=new Event("updateZoom");window.dispatchEvent(n),console.log("Карта области загружена")})},function(e){console.log(e)})}t.d(n,"a",function(){return o})},function(e,n,t){"use strict";var p=t(6),f=t(0);function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var y=function(){function a(e){var o=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),this._canvas=document.getElementById("canvas"),this._cehs=e,this._cehNames=Object.keys(e),this._cehDone=[],this._object={},this._isReady=!1,this._colors={"Великий Новгород":"#3c0","Залучье":"#ff9800","Пролетарий":"#673ab7","Боровичи":"#f44336"};var n=function(n){var t=new ymaps.GeoObjectCollection;f.a.serialAsyncMap(o._cehs[n].pins,function(t){return ymaps.route([e[n].coords,[t.lat,t.len]]).then(function(e){var n=e.getPaths();return n.id=t.name,n.options.set({strokeWidth:6,strokeColor:"rgba(0,0,0,0)"}),n})}).then(function(e){return e.forEach(function(e){return t.add(e)}),myMap.geoObjects.add(t),o._object[n]=t,n}).then(function(e){console.log("Маршруты цеха ".concat(e," построены")),o._cehDone.push(e),o._cehDone.length==o._cehNames.length&&(console.log("Маршруты всех цехов построены, выпускайте Кракена!"),o._canvas.classList.remove("loading"),o._isReady=!0)}).catch(function(e){console.log(e),o._canvas.classList.remove("loading"),o._canvas.classList.add("error")})};for(var t in this._cehs)n(t)}var e,n,t;return e=a,(n=[{key:"drawCehRoutes",value:function(e){this._object[e].each(function(e){e.options.set({strokeColor:"#87cefa"})})}},{key:"isReady",get:function(){return this._isReady}}])&&o(e.prototype,n),t&&o(e,t),a}();function a(e){var n=new TimelineLite({paused:!0}),t=new TimelineLite({paused:!0}),o=".ded-big",a=".deer",r=[a,o],c={};e.forEach(function(e){c.hasOwnProperty(e.ceh)?c[e.ceh].pins.push(e):c[e.ceh]={pins:[e]},e.ceh===e.name&&(c[e.ceh].coords=[e.lat,e.len])});var i=new y(c),s=Object(p.a)(e,i,c),u=SlowMo.ease.config(.2,.4),l={start:f.a.convertCoords(points[0][0]),end:f.a.convertCoords(points[points.length-1][1])},m={x:l.start[0],y:l.start[1]},h={x:l.end[0],y:l.end[1]};n.set(r,{x:innerWidth-30,y:innerHeight+300,rotation:60}).set(o,{scale:1.5,rotationY:180}),n.to(r,4,{bezier:{values:[{x:innerWidth-420,y:innerHeight-70},{x:m.x+200,y:m.y+200}]},rotation:"-=60",visibility:"visible"}).set(a,{className:"+=deer-stay"}).to(o,.5,{x:m.x+200,y:m.y+205}).to(o,1.2,{bezier:{values:[{x:m.x+170,y:m.y-70},m]},rotationY:"-=180",scale:1,ease:u,className:"+=ded-in-jump"}).set(o,{className:"-=ded-in-jump",visibility:"hidden"}).eventCallback("onComplete",s),t.set(["#map","#canvas"],{css:{backgroundColor:"rba(255,255,255,0)",filter:"blur(0)"}}).set(o,{x:h.x,y:h.y,visibility:"visible"}).to(a,2.7,{x:h.x+50,y:h.y+100,className:"-=deer-stay"}).set(a,{className:"+=deer-stay"}).to(o,.5,{x:h.x,y:h.y+5}).to(o,1.2,{bezier:{values:[{x:h.x+25,y:h.y-75},{x:h.x+50,y:h.y+100}]},rotationY:180,scale:1.5,ease:u,className:"+=ded-in-jump"}).set(o,{className:"-=ded-in-jump"}).to(r,3,{x:-50,y:h.y+190,className:"-=deer-stay",ease:Linear.easeNone}).to(["#map","#canvas"],.5,{css:{backgroundColor:"rba(255,255,255,0.3)",filter:"blur(1px)"}}).eventCallback("onComplete",function(){new Snowflakes({color:"lightskyblue",count:100,minSize:15,maxSize:30,minOpacity:.6,maxOpacity:.9})});var d=!1;window.addEventListener("launchLeaving",function(){t.restart()}),window.addEventListener("keydown",function(e){"Enter"===e.key&&i.isReady&&!d&&(d=!0,n.restart())})}t.d(n,"a",function(){return a})},function(e,n,t){"use strict";(function(u){t.d(n,"a",function(){return e});var l=t(7),m=t(1),h=t(0);function e(e,o,a){var n,r=new l.a({iconLayout:ymaps.templateLayoutFactory.createClass('<div class="ded ded-$[properties.direction]"></div>')});myMap.geoObjects.add(r),u.points=[[(n=a["Боровичи"].coords,[n[0]-5e-5,n[1]-5e-5]),a["Боровичи"].coords],[a["Боровичи"].coords,a["Залучье"].coords],[a["Залучье"].coords,a["Пролетарий"].coords],[a["Пролетарий"].coords,a["Великий Новгород"].coords]];var c=["Боровичи","Залучье","Пролетарий","Великий Новгород"],t=0,i=h.a.delay(function(e,n){e.properties.set("direction",""),o.drawCehRoutes(c[n]);var t=h.a.delay(function(e){if(e+1<c.length)myMap.geoObjects.add(r);else{console.log("Карта запущена"),myMap.geoObjects.remove(r);var n=new Event("launchLeaving");window.dispatchEvent(n)}},20);Object(m.a)(a[c[n]].pins,!0),t(n)},1e3);function s(n){if(0==n.length)return null;ymaps.route(n.shift()).then(function(e){r.moveTo(e.getPaths().get(0).getSegments(),{speed:3e3,directions:2},function(e,n,t){e.geometry.setCoordinates(n),e.properties.set("direction",t.t)},function(e){e.properties.set("direction","jump"),i(e,t++),h.a.delay(s,1500)(n)})})}return function(){s(points)}}}).call(this,t(3))},function(e,n,t){"use strict";t.d(n,"a",function(){return o});var v,o=(v={arrows:{w:"←",sw:"↙",s:"↓",se:"↘",e:"→",ne:"↗",n:"↑",nw:"↖"},classes:{16:["w","sww","sw","ssw","s","sse","se","see","e","nee","ne","nne","n","nnw","nw","nww"],8:["w","sw","s","se","e","ne","n","nw"],4:["w","s","e","n"],2:["w","e"]},n:function(e,n,t){var o=t>>1,a=(Math.floor(Math.atan2(e,n)/Math.PI*o+1/t)+o)%t;return{n:a,t:v.classes[t][a]}},16:function(e,n){return v.n(e,n,16)},8:function(e,n){return v.n(e,n,8)},4:function(e,n){return v.n(e,n,4)},2:function(e,n){return v.n(e,n,2)}},function(e){var n=new ymaps.GeoObject({geometry:{type:"Point"}},e);return n.coordSystem=e.coordSystem,n.waypoints=[],n.stop=function(){this.waypoints.length=0},n.moveTo=function(e,n,t,o){var a=this;if(e){(n=n||{}).coordSystem=n.coordSystem||this.coordSystem||this.getMap().options.get("projection").getCoordSystem(),n.speed=n.speed||Math.round(1e3/this.getMap().getZoom());var r=function(e,n){var t,o;(n=n||{}).directions=0<=[2,4,8,16].indexOf(n.directions)?n.directions:8,n.speed=n.speed||6;var a,r,c,i,s,u,l,m=[],h=v[n.directions],d=n.coordSystem;for(t=[],a=0,i=e.length;a<i;a++)for(r=0,c=(o=e[a].getCoordinates()).length;r<c;r++)u=o[r],s&&s[0].toPrecision(10)===u[0].toPrecision(10)&&s[1].toPrecision(10)===u[1].toPrecision(10)||(t.push(u),s=u);for(a=0,i=t.length-1;i;--i,++a){var p=t[a],f=t[a+1],y=[f[0]-p[0],f[1]-p[1]];for(l=h(y[0],y[1]),r=0,c=Math.round(d.distance(p,f));r<c;r+=n.speed)m.push({coords:[p[0]+y[0]*r/c,p[1]+y[1]*r/c],direction:l,vector:y})}return m}(e,n),c=[];this.waypoints=r.map(function(e,n){return c.push(e),2<=c.length&&e.direction.t!==c[c.length-2].direction.t&&(20<c.length?c=[e]:(e.direction.t=c[c.length-2].direction.t,c.splice(c.length-1,1,e))),c[c.length-1]});var i=setInterval(function(){if(0===a.waypoints.length)return o(a),clearTimeout(i);var e=a.waypoints.shift();t(a,e.coords,e.direction)},8)}},n})},,function(e,n,t){e.exports=t(10)},function(e,n,r){"use strict";r.r(n),function(e){r(11);var n=r(2),t=r(4),o=r(1),a=r(5);ymaps.ready(function(){e.myMap=new ymaps.Map("map",{center:[58.19421684348514,32.92976749999997],controls:[],zoom:8.23},{avoidFractionalZoom:!1}),myMap.behaviors.disable(["drag","scrollZoom","dblClickZoom"]),Object(t.a)(),e.pinsObject=new ymaps.ObjectManager,Object(o.a)(n.a),window.addEventListener("updateZoom",function(){Object(a.a)(n.a)})})}.call(this,r(3))},function(e,n,t){}]);
//# sourceMappingURL=bundle.js.map